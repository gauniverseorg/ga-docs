name: SSH into Instance

on:
  push:
    branches:
      - master

jobs:
  ssh:
    runs-on: ubuntu-latest
    steps:
    - name: Checkout code
      uses: actions/checkout@v2

    - name: Install ssh client
      run: sudo apt-get install -y sshpass

    - name: SSH into instance and execute commands
      run: |
        sshpass -p 'Qmobilea34@' ssh -o StrictHostKeyChecking=no -p 22 ubuntu@44.195.207.159 << 'EOF'
          cd /home/ubuntu/ga-docs
          sudo rm -rf build
          sudo npm i
          sudo npm run build
          sudo systemctl restart nginx
        EOF
